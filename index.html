<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <title>TIMER</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            background: radial-gradient(circle at top, #1f2933, #020617);
            color: #f9fafb;
            min-height: 100vh;
            display: flex;
            align-items: stretch;
            justify-content: center;
        }

        .app {
            max-width: 960px;
            margin: 0 auto;
            padding: 24px 16px 32px;
            display: flex;
            flex-direction: column;
            gap: 24px;
            width: 100%;
        }

        header { text-align: center; }
        header h1 {
            font-size: clamp(1.4rem, 2.3vw, 1.9rem);
            font-weight: 600;
            margin-bottom: 10px;
            color: #e5e7eb;
        }

        .note-display {
            min-height: 2.4em;
            font-size: clamp(1.1rem, 2vw, 1.4rem);
            color: #facc15;
            font-weight: 500;
        }

        .note-display.placeholder {
            color: #9ca3af;
            font-style: italic;
            font-weight: 400;
        }

        main {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 24px;
            align-items: center;
            justify-content: center;
        }

        #timer {
            font-size: clamp(4rem, 20vw, 9rem);
            font-weight: 700;
            text-align: center;
            letter-spacing: 0.08em;
            text-shadow: 0 0 20px rgba(15, 23, 42, 0.9);
        }

        #timer.finished {
            color: #f97316;
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.03); }
            100% { transform: scale(1); }
        }

        .end-time {
            color: #9ca3af;
            margin-top: 8px;
            font-size: clamp(1.1rem, 1.6vw, 1.3rem);
        }

        .controls {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 12px;
        }

        button {
            border: none;
            border-radius: 9999px;
            padding: 8px 18px;
            font-size: 0.95rem;
            font-weight: 500;
            cursor: pointer;
            transition: 0.12s;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        button:disabled { opacity: 0.6; cursor: not-allowed; }

        #newCountdownBtn { background: #2563eb; color: white; }
        #startStopBtn { background: #16a34a; color: white; }
        #startStopBtn.running { background: #ea580c; }
        #noteBtn, #resetBtn, #fullscreenBtn { background: #111827; color: #e5e7eb; border: 1px solid #374151; }

        footer {
            text-align: center;
            color: #6b7280;
            margin-top: auto;
            font-size: 0.8rem;
        }

        .modal-overlay {
            position: fixed;
            inset: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            background: rgba(15,23,42,0.7);
            z-index: 50;
        }

        .modal {
            background: #020617;
            border: 1px solid #1f2937;
            border-radius: 16px;
            padding: 20px;
            width: min(420px, 92vw);
        }

        .modal input, .modal textarea {
            width: 100%;
            padding: 8px 10px;
            margin-top: 6px;
            margin-bottom: 16px;
            background: #020617;
            border-radius: 10px;
            border: 1px solid #4b5563;
            color: white;
        }

        .modal-actions { display: flex; justify-content: flex-end; gap: 8px; }
        .btn-secondary { background: #111827; color:white; border:1px solid #4b5563; }
        .btn-primary { background:#3b82f6;color:white; }

        .hidden { display: none; }
    </style>
</head>

<body>
<div class="app">
    <header>
        <h1>Timer</h1>
        <div id="noteDisplay" class="note-display placeholder">
            P≈ôidej si pozn√°mku (nap≈ô. ‚ÄûP≈ôest√°vka‚Äú) tlaƒç√≠tkem n√≠≈æe.
        </div>
    </header>

    <main>
        <div class="timer-display"><span id="timer">00:00</span></div>
        <div class="end-time"><span id="endTimeLabel">Konec v: <strong>--:--</strong></span></div>

        <div class="controls">
            <button id="newCountdownBtn">Nov√Ω odpoƒçet</button>
            <button id="startStopBtn" disabled>Start</button>
            <button id="resetBtn" disabled>Reset</button>
            <button id="noteBtn">Pozn√°mka</button>
            <button id="fullscreenBtn">Cel√° obrazovka</button>
        </div>

        <div id="statusMessage" class="status-message"></div>
    </main>

    <footer>Jednoduch√° ƒçasom√≠ra ‚Äì HTML / CSS / JS</footer>

    <!-- MOD√ÅL: ODPOƒåET -->
    <div id="countdownModal" class="modal-overlay hidden">
        <div class="modal">
            <h2>Nastavit odpoƒçet</h2>
            <label for="minutesInput">Poƒçet minut (1‚Äì600):</label>

            <!-- üî• TADY JE NOV√ù INPUT S PLACEHOLDEREM -->
            <input type="number" id="minutesInput" min="1" max="600" placeholder="Zadejte poƒçet minut">

            <div class="modal-actions">
                <button class="btn-secondary" data-close-modal="countdownModal">Zru≈°it</button>
                <button class="btn-primary" id="saveCountdownBtn">Ulo≈æit</button>
            </div>
        </div>
    </div>

    <!-- MOD√ÅL: POZN√ÅMKA -->
    <div id="noteModal" class="modal-overlay hidden">
        <div class="modal">
            <h2>Nastavit pozn√°mku</h2>
            <label for="noteInput">Text pozn√°mky:</label>
            <textarea id="noteInput" placeholder="P≈ôest√°vka"></textarea>
            <div class="modal-actions">
                <button class="btn-secondary" data-close-modal="noteModal">Zru≈°it</button>
                <button class="btn-primary" id="saveNoteBtn">Ulo≈æit</button>
            </div>
        </div>
    </div>
</div>

<script>
/* ===== LOGIKA A OVL√ÅD√ÅN√ç ===== */
let initialDurationMs = 0;
let remainingMs = 0;
let timerInterval = null;
let isRunning = false;
let endTime = null;

const timerEl = document.getElementById('timer');
const endTimeLabelEl = document.getElementById('endTimeLabel');
const statusMessageEl = document.getElementById('statusMessage');
const noteDisplayEl = document.getElementById('noteDisplay');

const newCountdownBtn = document.getElementById('newCountdownBtn');
const startStopBtn = document.getElementById('startStopBtn');
const resetBtn = document.getElementById('resetBtn');
const noteBtn = document.getElementById('noteBtn');
const fullscreenBtn = document.getElementById('fullscreenBtn');

const countdownModal = document.getElementById('countdownModal');
const minutesInput = document.getElementById('minutesInput');
const saveCountdownBtn = document.getElementById('saveCountdownBtn');

const noteModal = document.getElementById('noteModal');
const noteInput = document.getElementById('noteInput');
const saveNoteBtn = document.getElementById('saveNoteBtn');

function formatTime(ms) {
    const total = Math.max(0, Math.floor(ms / 1000));
    const m = String(Math.floor(total / 60)).padStart(2, '0');
    const s = String(total % 60).padStart(2, '0');
    return m + ":" + s;
}

function formatClock(date) {
    if (!date) return "--:--";
    return String(date.getHours()).padStart(2, '0') + ":" + String(date.getMinutes()).padStart(2, '0');
}

function updateTimer() { timerEl.textContent = formatTime(remainingMs); }
function updateEndTime() { endTimeLabelEl.innerHTML = "Konec v: <strong>" + formatClock(endTime) + "</strong>"; }
function setStatus(t) { statusMessageEl.textContent = t || ""; }

function openModal(modal) { modal.classList.remove("hidden"); }
function closeModal(modal) { modal.classList.add("hidden"); }

[countdownModal, noteModal].forEach(modal => {
    modal.addEventListener("click", e => { if (e.target === modal) closeModal(modal); });
});

document.querySelectorAll("[data-close-modal]").forEach(btn => {
    btn.addEventListener("click", () => {
        closeModal(document.getElementById(btn.dataset.closeModal));
    });
});

function startTimer() {
    if (initialDurationMs <= 0) return setStatus("Nejprve nastav odpoƒçet.");

    if (remainingMs <= 0) remainingMs = initialDurationMs;

    endTime = new Date(Date.now() + remainingMs);
    updateEndTime();

    isRunning = true;
    startStopBtn.textContent = "Stop";
    startStopBtn.classList.add("running");

    if (timerInterval) clearInterval(timerInterval);

    timerInterval = setInterval(() => {
        remainingMs = endTime - Date.now();
        if (remainingMs <= 0) {
            remainingMs = 0;
            clearInterval(timerInterval);
            timerInterval = null;
            isRunning = false;
            startStopBtn.textContent = "Start";
            startStopBtn.classList.remove("running");
            timerEl.classList.add("finished");
            setStatus("ƒåas vypr≈°el.");
        }
        updateTimer();
    }, 200);

    updateTimer();
}

function stopTimer() {
    if (!isRunning) return;
    isRunning = false;
    clearInterval(timerInterval);
    remainingMs = Math.max(0, endTime - Date.now());
    startStopBtn.textContent = "Start";
    startStopBtn.classList.remove("running");
    setStatus("Odpoƒçet pozastaven.");
    updateTimer();
}

function resetTimer() {
    if (!initialDurationMs) return;
    clearInterval(timerInterval);
    remainingMs = initialDurationMs;
    endTime = null;
    isRunning = false;
    startStopBtn.textContent = "Start";
    startStopBtn.classList.remove("running");
    timerEl.classList.remove("finished");
    updateTimer();
    updateEndTime();
    setStatus("Odpoƒçet resetov√°n.");
}

newCountdownBtn.addEventListener("click", () => {
    minutesInput.value = "";
    openModal(countdownModal);
    minutesInput.focus();
});

saveCountdownBtn.addEventListener("click", () => {
    const minutes = parseInt(minutesInput.value, 10);
    if (isNaN(minutes) || minutes < 1 || minutes > 600)
        return setStatus("Zadej pros√≠m poƒçet minut mezi 1 a 600.");

    initialDurationMs = minutes * 60000;
    remainingMs = initialDurationMs;
    clearInterval(timerInterval);
    isRunning = false;
    endTime = null;

    updateTimer();
    updateEndTime();
    setStatus("Odpoƒçet nastaven na " + minutes + " minut.");

    startStopBtn.disabled = false;
    resetBtn.disabled = false;

    closeModal(countdownModal);
});

startStopBtn.addEventListener("click", () => {
    isRunning ? stopTimer() : startTimer();
});

resetBtn.addEventListener("click", resetTimer);

noteBtn.addEventListener("click", () => {
    noteInput.value = noteDisplayEl.classList.contains("placeholder") ? "" : noteDisplayEl.textContent;
    openModal(noteModal);
    noteInput.focus();
});

saveNoteBtn.addEventListener("click", () => {
    const t = noteInput.value.trim();
    if (!t) {
        noteDisplayEl.textContent = "P≈ôidej si pozn√°mku (nap≈ô. ‚ÄûP≈ôest√°vka‚Äú) tlaƒç√≠tkem n√≠≈æe.";
        noteDisplayEl.classList.add("placeholder");
    } else {
        noteDisplayEl.textContent = t;
        noteDisplayEl.classList.remove("placeholder");
    }
    closeModal(noteModal);
});

fullscreenBtn.addEventListener("click", () => {
    document.fullscreenElement
        ? document.exitFullscreen()
        : document.documentElement.requestFullscreen();
});

document.addEventListener("fullscreenchange", () => {
    fullscreenBtn.textContent = document.fullscreenElement
        ? "Ukonƒçit celou obrazovku"
        : "Cel√° obrazovka";
});

updateTimer();
updateEndTime();
setStatus("Nastav odpoƒçet tlaƒç√≠tkem ‚ÄûNov√Ω odpoƒçet‚Äú.");
</script>
</body>
</html>
